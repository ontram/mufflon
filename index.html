<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>mufflonapp</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link href="styles.css" rel="stylesheet" />
  </head>
  <body class="bg-light">
    <div id="app">
      <div class="container mt-5">
        <div class="page-header">
          <h1>Text übersetzen mit ModernMT</h1>
          <p class="">Text eingeben, Ergebnis anschauen - so einfach kann es sein.</p>
        </div>

        <div id="liveAlertPlaceholder" class="mt-3"></div>

        <form>
          <!-- Authentification -->
          <div class="card" v-if="!apiKeyOk">
            <div class="card-body">
              <div class="card-title"><h4>Authentifizierung</h4></div>
              <div class="card-text">
                <label for="exampleInputEmail1">API-Key</label>
                <input
                  v-model="apiKey"
                  type="text"
                  class="form-control mt-2"
                  id="inputApiKey"
                  aria-describedby="api key"
                  placeholder="API-Key eingeben"
                />
                <button type="submit" class="btn btn-primary mt-3" v-on:click.prevent="saveApiKey">Session starten</button>
              </div>
            </div>
          </div>
          <!-- Translation -->
          <div class="card" v-if="apiKeyOk">
            <div class="card-body">
              <div class="card-text">
                <div class="row">
                  <div class="col-md-6 mt-2">
                    <div class="input-group mb-2">
                      <label class="input-group-text" for="inputGroupSelect01">Von </label>
                      <select class="form-select" aria-label="Zielsprache" v-model="sourceLanguage">
                        <option value="" selected>Sprache erkennen...</option>
                        <option v-for="lang in languages" :value="lang.code">{{lang.name}}</option>
                      </select>
                    </div>

                    <textarea
                      v-model="sourceText"
                      id="sourceText"
                      cols="30"
                      rows="10"
                      class="form-control mt-2 fs-5"
                      placeholder="Text in der Ausgangssprache eingeben"
                    ></textarea>
                  </div>
                  <div class="col-md-6 mt-2">
                    <div class="input-group mb-2">
                      <label class="input-group-text" for="inputGroupSelect01">Nach </label>
                      <select class="form-select" aria-label="Zielsprache" v-model="targetLanguage">
                        <option v-for="lang in languages" :value="lang.code">{{lang.name}}</option>
                      </select>
                    </div>

                    <div id="translatedText" class="card mt-2">
                      <div class="card-body p-2">
                        <p class="fs-5 m-1">{{translation}}</p>
                      </div>
                    </div>

                    <div id="altTrans" class="text-diff mt-2" v-if="altTranslations.length > 0">
                      <ul class="nav nav-tabs mb-1 bg-light" id="myTab" role="tablist">
                        <li class="nav-item" role="presentation">
                          <button
                            class="nav-link"
                            id="disabled-tab"
                            data-bs-toggle="pill"
                            data-bs-target="#pills-disabled"
                            type="button"
                            role="tab"
                            disabled
                          >
                            Alternativen:
                          </button>
                        </li>
                        <li v-for="(translation, index) in altTranslations" class="nav-item" role="presentation">
                          <button
                            class="nav-link"
                            :class="{ 'active' : index === 0 }"
                            :id="'tabAlt' + index"
                            data-bs-toggle="tab"
                            :data-bs-target="'#alt' + index"
                            type="button"
                            role="tab"
                          >
                            {{index+1}}
                          </button>
                        </li>
                      </ul>
                      <div class="tab-content p-1" id="myTabContent">
                        <div
                          v-for="(translation, index) in altTranslations"
                          class="tab-pane fade"
                          :class="{ 'show active' : index === 0 }"
                          :id="'alt' + index"
                          role="tabpanel"
                        >
                          <p class="" v-html="getTextDiff(translation)"></p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row mt-3"></div>
                <button type="submit" class="btn btn-primary me-1" v-on:click.prevent="translate">Text übersetzen</button>
                <button type="submit" class="btn btn-light me-1" v-on:click.prevent="invalidateApiKey">App zurücksetzen</button>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="diff.js"></script>
    <script src="data.js"></script>
    <script src="app.js"></script>
  </body>
</html>
